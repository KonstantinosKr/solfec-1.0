# A SPHERICAL SHELL WITH A HOLE UNDER NODAL LOADS

def create_simulation (step, stop, outstep):
  Dir_out='out/tests/BM03_hexa_step_'+str(step)+'s'
  GEOMETRIC_EPSILON (1E-5)
  
  solfec=SOLFEC ('QUASI_STATIC', step, Dir_out)

  Nodes_M1=[
        0.0000000E+00, 0.0000000E+00, 0.1000000E+02,
        0.0000000E+00, 0.1251000E+01, 0.9921440E+01,
        0.0000000E+00, 0.2485900E+01, 0.9686090E+01,
        0.0000000E+00, 0.3681930E+01, 0.9297500E+01,
        0.0000000E+00, 0.4818550E+01, 0.8762510E+01,
        0.0000000E+00, 0.5878590E+01, 0.8089630E+01,
        0.0000000E+00, 0.6845900E+01, 0.7289290E+01,
        0.0000000E+00, 0.7705550E+01, 0.6373730E+01,
        0.0000000E+00, 0.8444230E+01, 0.5356770E+01,
        0.0000000E+00, 0.9049360E+01, 0.4255480E+01,
       -0.1370000E-14, 0.9510570E+01, 0.3090170E+01,
        0.1562240E+01, 0.0000000E+00, 0.9877220E+01,
        0.1524470E+01, 0.1258360E+01, 0.9802680E+01,
        0.1467810E+01, 0.2510740E+01, 0.9567740E+01,
        0.1392570E+01, 0.3727230E+01, 0.9174340E+01,
        0.1299960E+01, 0.4880710E+01, 0.8630690E+01,
        0.1191540E+01, 0.5949270E+01, 0.7948990E+01,
        0.1069220E+01, 0.6914590E+01, 0.7144590E+01,
        0.9350740E+00, 0.7762390E+01, 0.6234650E+01,
        0.7912620E+00, 0.8482370E+01, 0.5236730E+01,
        0.6399840E+00, 0.9066760E+01, 0.4169450E+01,
        0.4834260E+00, 0.9510570E+01, 0.3052110E+01,
        0.3090760E+01, 0.0000000E+00, 0.9510370E+01,
        0.3032400E+01, 0.1264570E+01, 0.9444860E+01,
        0.2931040E+01, 0.2532120E+01, 0.9219400E+01,
        0.2787040E+01, 0.3766530E+01, 0.8834350E+01,
        0.2603400E+01, 0.4934720E+01, 0.8298850E+01,
        0.2384550E+01, 0.6010510E+01, 0.7628090E+01,
        0.2135940E+01, 0.6973810E+01, 0.6841330E+01,
        0.1863360E+01, 0.7811090E+01, 0.5959430E+01,
        0.1572340E+01, 0.8514880E+01, 0.5002460E+01,
        0.1268050E+01, 0.9081550E+01, 0.3989670E+01,
        0.9550650E+00, 0.9510570E+01, 0.2938880E+01,
        0.4542070E+01, 0.0000000E+00, 0.8908960E+01,
        0.4477300E+01, 0.1269330E+01, 0.8851130E+01,
        0.4342660E+01, 0.2548690E+01, 0.8639760E+01,
        0.4138040E+01, 0.3797110E+01, 0.8273970E+01,
        0.3868430E+01, 0.4976750E+01, 0.7763190E+01,
        0.3541940E+01, 0.6058050E+01, 0.7124230E+01,
        0.3168650E+01, 0.7019560E+01, 0.6378520E+01,
        0.2759060E+01, 0.7848510E+01, 0.5548730E+01,
        0.2322880E+01, 0.8539750E+01, 0.4655840E+01,
        0.1868670E+01, 0.9092860E+01, 0.3718610E+01,
        0.1403440E+01, 0.9510570E+01, 0.2753070E+01,
        0.5880020E+01, 0.0000000E+00, 0.8088590E+01,
        0.5817540E+01, 0.1272450E+01, 0.8033500E+01,
        0.5658270E+01, 0.2559400E+01, 0.7837950E+01,
        0.5401370E+01, 0.3816800E+01, 0.7500480E+01,
        0.5053660E+01, 0.5003730E+01, 0.7030160E+01,
        0.4627030E+01, 0.6088440E+01, 0.6443720E+01,
        0.4136360E+01, 0.7048670E+01, 0.5762530E+01,
        0.3597120E+01, 0.7872210E+01, 0.5008890E+01,
        0.3023250E+01, 0.8555440E+01, 0.4202900E+01,
        0.2426770E+01, 0.9099970E+01, 0.3361750E+01,
        0.1817100E+01, 0.9510560E+01, 0.2499460E+01,
        0.7073370E+01, 0.0000000E+00, 0.7068760E+01,
        0.7015690E+01, 0.1273600E+01, 0.7011280E+01,
        0.6836960E+01, 0.2563170E+01, 0.6832730E+01,
        0.6535730E+01, 0.3823650E+01, 0.6531770E+01,
        0.6120250E+01, 0.5013080E+01, 0.6116500E+01,
        0.5605500E+01, 0.6098930E+01, 0.5601910E+01,
        0.5010410E+01, 0.7058680E+01, 0.5007080E+01,
        0.4354570E+01, 0.7880340E+01, 0.4351770E+01,
        0.3655630E+01, 0.8560830E+01, 0.3653580E+01,
        0.2928690E+01, 0.9102410E+01, 0.2927260E+01,
        0.2185560E+01, 0.9510570E+01, 0.2184600E+01,
        0.8092470E+01, 0.0000000E+00, 0.5874690E+01,
        0.8037190E+01, 0.1272460E+01, 0.5812440E+01,
        0.7841500E+01, 0.2559310E+01, 0.5653380E+01,
        0.7503850E+01, 0.3816580E+01, 0.5396840E+01,
        0.7033400E+01, 0.5003460E+01, 0.5049430E+01,
        0.6446870E+01, 0.6088150E+01, 0.4623020E+01,
        0.5765490E+01, 0.7048400E+01, 0.4132690E+01,
        0.5011400E+01, 0.7872030E+01, 0.3594030E+01,
        0.4204710E+01, 0.8555370E+01, 0.3020940E+01,
        0.3362980E+01, 0.9099960E+01, 0.2425100E+01,
        0.2500290E+01, 0.9510570E+01, 0.1815950E+01,
        0.8911630E+01, 0.0000000E+00, 0.4536840E+01,
        0.8853640E+01, 0.1269260E+01, 0.4472350E+01,
        0.8642200E+01, 0.2548380E+01, 0.4337980E+01,
        0.8276370E+01, 0.3796520E+01, 0.4133780E+01,
        0.7765600E+01, 0.4976030E+01, 0.3864520E+01,
        0.7126650E+01, 0.6057320E+01, 0.3538320E+01,
        0.6380850E+01, 0.7018910E+01, 0.3165400E+01,
        0.5550710E+01, 0.7848050E+01, 0.2756390E+01,
        0.4657180E+01, 0.8539550E+01, 0.2320940E+01,
        0.3719380E+01, 0.9092810E+01, 0.1867330E+01,
        0.2753520E+01, 0.9510570E+01, 0.1402600E+01,
        0.9511470E+01, 0.0000000E+00, 0.3087390E+01,
        0.9445900E+01, 0.1264360E+01, 0.3029240E+01,
        0.9220520E+01, 0.2531470E+01, 0.2928080E+01,
        0.8835650E+01, 0.3765410E+01, 0.2784400E+01,
        0.8300380E+01, 0.4933400E+01, 0.2601020E+01,
        0.7629790E+01, 0.6009210E+01, 0.2382370E+01,
        0.6843090E+01, 0.6972670E+01, 0.2134000E+01,
        0.5960960E+01, 0.7810290E+01, 0.1861810E+01,
        0.5003420E+01, 0.8514510E+01, 0.1571280E+01,
        0.3990080E+01, 0.9081470E+01, 0.1267380E+01,
        0.2938990E+01, 0.9510570E+01, 0.9547050E+00,
        0.9877370E+01, 0.0000000E+00, 0.1561250E+01,
        0.9802860E+01, 0.1258100E+01, 0.1523540E+01,
        0.9568100E+01, 0.2509910E+01, 0.1466920E+01,
        0.9175040E+01, 0.3725800E+01, 0.1391790E+01,
        0.8631750E+01, 0.4879030E+01, 0.1299250E+01,
        0.7950320E+01, 0.5947620E+01, 0.1190860E+01,
        0.7146070E+01, 0.6913170E+01, 0.1068580E+01,
        0.6235980E+01, 0.7761390E+01, 0.9345710E+00,
        0.5237520E+01, 0.8481910E+01, 0.7909390E+00,
        0.4169730E+01, 0.9066640E+01, 0.6397870E+00,
        0.3052140E+01, 0.9510560E+01, 0.4833240E+00,
        0.1000000E+02, 0.0000000E+00, 0.0000000E+00,
        0.9921470E+01, 0.1250740E+01, 0.0000000E+00,
        0.9686320E+01, 0.2484990E+01, 0.0000000E+00,
        0.9298130E+01, 0.3680310E+01, 0.0000000E+00,
        0.8763560E+01, 0.4816650E+01, 0.0000000E+00,
        0.8090980E+01, 0.5876740E+01, 0.0000000E+00,
        0.7290780E+01, 0.6844310E+01, 0.0000000E+00,
        0.6375070E+01, 0.7704440E+01, 0.0000000E+00,
        0.5357550E+01, 0.8443740E+01, 0.0000000E+00,
        0.4255710E+01, 0.9049250E+01, 0.0000000E+00,
        0.3090170E+01, 0.9510570E+01, 0.0000000E+00,
        0.7819758E-02, 0.6248239E-02, 0.1009950E+02,
        0.7661084E-02, 0.1263507E+01, 0.1002056E+02,
        0.7383618E-02, 0.2510742E+01, 0.9782878E+01,
        0.7021749E-02, 0.3718730E+01, 0.9390430E+01,
        0.6580113E-02, 0.4866728E+01, 0.8850119E+01,
        0.6061982E-02, 0.5937387E+01, 0.8170538E+01,
        0.5469004E-02, 0.6914397E+01, 0.7362218E+01,
        0.4799449E-02, 0.7782676E+01, 0.6437519E+01,
        0.4060999E-02, 0.8528774E+01, 0.5410401E+01,
        0.3265799E-02, 0.9139984E+01, 0.4298104E+01,
        0.2896102E-02, 0.9603514E+01, 0.3126955E+01,
        0.1577891E+01, 0.6326856E-02, 0.9976097E+01,
        0.1539746E+01, 0.1270868E+01, 0.9901214E+01,
        0.1482645E+01, 0.2535871E+01, 0.9663893E+01,
        0.1406789E+01, 0.3764652E+01, 0.9266487E+01,
        0.1313384E+01, 0.4929791E+01, 0.8717292E+01,
        0.1203992E+01, 0.6009125E+01, 0.8028648E+01,
        0.1080529E+01, 0.6984134E+01, 0.7216087E+01,
        0.9450738E+00, 0.7840392E+01, 0.6296970E+01,
        0.7997898E+00, 0.8567505E+01, 0.5289065E+01,
        0.6468591E+00, 0.9157649E+01, 0.4211197E+01,
        0.4891595E+00, 0.9603665E+01, 0.3088284E+01,
        0.3121698E+01, 0.6359882E-02, 0.9605577E+01,
        0.3062767E+01, 0.1277103E+01, 0.9539838E+01,
        0.2960508E+01, 0.2557416E+01, 0.9312089E+01,
        0.2815186E+01, 0.3804281E+01, 0.8923115E+01,
        0.2629816E+01, 0.4984263E+01, 0.8382152E+01,
        0.2408862E+01, 0.6070891E+01, 0.7704559E+01,
        0.2157822E+01, 0.7043861E+01, 0.6909816E+01,
        0.1882538E+01, 0.7889506E+01, 0.6019016E+01,
        0.1588585E+01, 0.8600287E+01, 0.5052457E+01,
        0.1281161E+01, 0.9172559E+01, 0.4029601E+01,
        0.9663405E+00, 0.9603729E+01, 0.2973557E+01,
        0.4587534E+01, 0.6383147E-02, 0.8998146E+01,
        0.4522201E+01, 0.1281942E+01, 0.8940160E+01,
        0.4386301E+01, 0.2574148E+01, 0.8726645E+01,
        0.4179718E+01, 0.3835126E+01, 0.8357135E+01,
        0.3907480E+01, 0.5026641E+01, 0.7841157E+01,
        0.3577775E+01, 0.6118814E+01, 0.7195706E+01,
        0.3200778E+01, 0.7089971E+01, 0.6442442E+01,
        0.2787094E+01, 0.7927212E+01, 0.5604282E+01,
        0.2346530E+01, 0.8625340E+01, 0.4702435E+01,
        0.1887717E+01, 0.9183945E+01, 0.3755863E+01,
        0.1419947E+01, 0.9603779E+01, 0.2785440E+01,
        0.5938882E+01, 0.6395780E-02, 0.8169559E+01,
        0.5875963E+01, 0.1285169E+01, 0.8114297E+01,
        0.5715149E+01, 0.2584993E+01, 0.7916773E+01,
        0.5455723E+01, 0.3854990E+01, 0.7575894E+01,
        0.5104567E+01, 0.5053824E+01, 0.7100820E+01,
        0.4673686E+01, 0.6149413E+01, 0.6508455E+01,
        0.4178108E+01, 0.7119267E+01, 0.5820392E+01,
        0.3633459E+01, 0.7951054E+01, 0.5059164E+01,
        0.3053822E+01, 0.8641116E+01, 0.4245082E+01,
        0.2451334E+01, 0.9191085E+01, 0.3395514E+01,
        0.1838419E+01, 0.9603800E+01, 0.2528784E+01,
        0.7144177E+01, 0.6400359E-02, 0.7139521E+01,
        0.7086210E+01, 0.1286422E+01, 0.7081757E+01,
        0.6905703E+01, 0.2588839E+01, 0.6901431E+01,
        0.6601469E+01, 0.3861890E+01, 0.6597470E+01,
        0.6181836E+01, 0.5063201E+01, 0.6178049E+01,
        0.5661932E+01, 0.6159912E+01, 0.5658307E+01,
        0.5060875E+01, 0.7129272E+01, 0.5057512E+01,
        0.4398449E+01, 0.7959171E+01, 0.4395623E+01,
        0.3692484E+01, 0.8646490E+01, 0.3690416E+01,
        0.2958234E+01, 0.9193510E+01, 0.2956791E+01,
        0.2211182E+01, 0.9603821E+01, 0.2210212E+01,
        0.8173477E+01, 0.6396275E-02, 0.5933500E+01,
        0.8118014E+01, 0.1285354E+01, 0.5870806E+01,
        0.7920346E+01, 0.2584972E+01, 0.5710204E+01,
        0.7579306E+01, 0.3854728E+01, 0.5451159E+01,
        0.7104142E+01, 0.5053420E+01, 0.5100335E+01,
        0.6511735E+01, 0.6148933E+01, 0.4669711E+01,
        0.5823523E+01, 0.7118793E+01, 0.4174507E+01,
        0.5061861E+01, 0.7950693E+01, 0.3630460E+01,
        0.4247061E+01, 0.8640915E+01, 0.3051603E+01,
        0.3396866E+01, 0.9191003E+01, 0.2449728E+01,
        0.2529623E+01, 0.9603809E+01, 0.1837258E+01,
        0.9000840E+01, 0.6383328E-02, 0.4582255E+01,
        0.8942678E+01, 0.1282171E+01, 0.4517190E+01,
        0.8729088E+01, 0.2573944E+01, 0.4381567E+01,
        0.8359582E+01, 0.3834440E+01, 0.4175435E+01,
        0.7843700E+01, 0.5025657E+01, 0.3903595E+01,
        0.7198360E+01, 0.6117717E+01, 0.3574231E+01,
        0.6445092E+01, 0.7088929E+01, 0.3197649E+01,
        0.5606620E+01, 0.7926407E+01, 0.2784570E+01,
        0.4704105E+01, 0.8624892E+01, 0.2344731E+01,
        0.3756865E+01, 0.9183761E+01, 0.1886477E+01,
        0.2785897E+01, 0.9603778E+01, 0.1419097E+01,
        0.9606687E+01, 0.6359282E-02, 0.3118294E+01,
        0.9540870E+01, 0.1277215E+01, 0.3059562E+01,
        0.9313204E+01, 0.2556841E+01, 0.2957513E+01,
        0.8924480E+01, 0.3802976E+01, 0.2812542E+01,
        0.8383872E+01, 0.4982544E+01, 0.2627475E+01,
        0.7706595E+01, 0.6069065E+01, 0.2406767E+01,
        0.6912033E+01, 0.7042171E+01, 0.2156005E+01,
        0.6021056E+01, 0.7888227E+01, 0.1881129E+01,
        0.5053883E+01, 0.8599577E+01, 0.1587657E+01,
        0.4030329E+01, 0.9172302E+01, 0.1280581E+01,
        0.2973669E+01, 0.9603729E+01, 0.9659743E+00,
        0.9976249E+01, 0.6324735E-02, 0.1576887E+01,
        0.9901383E+01, 0.1270810E+01, 0.1538797E+01,
        0.9664263E+01, 0.2534995E+01, 0.1481745E+01,
        0.9267291E+01, 0.3762908E+01, 0.1406018E+01,
        0.8718606E+01, 0.4927576E+01, 0.1312708E+01,
        0.8030402E+01, 0.6006814E+01, 0.1203371E+01,
        0.7218129E+01, 0.6982043E+01, 0.1079966E+01,
        0.6298916E+01, 0.7838820E+01, 0.9446556E+00,
        0.5290406E+01, 0.8566648E+01, 0.7995432E+00,
        0.4211835E+01, 0.9157334E+01, 0.6467103E+00,
        0.3088316E+01, 0.9603655E+01, 0.4890563E+00,
        0.1009950E+02, 0.6247178E-02, 0.7815191E-02,
        0.1002059E+02, 0.1263244E+01, 0.7656071E-02,
        0.9783111E+01, 0.2509823E+01, 0.7378520E-02,
        0.9391067E+01, 0.3717094E+01, 0.7017049E-02,
        0.8851179E+01, 0.4864809E+01, 0.6576847E-02,
        0.8171901E+01, 0.5935520E+01, 0.6059531E-02,
        0.7363722E+01, 0.6912792E+01, 0.5464979E-02,
        0.6438871E+01, 0.7781556E+01, 0.4796219E-02,
        0.5411189E+01, 0.8528279E+01, 0.4060259E-02,
        0.4298337E+01, 0.9139873E+01, 0.3265350E-02,
        0.3126957E+01, 0.9603513E+01, 0.2896456E-02,]
  #ELEM_TETRA4
  ############
  #ELEM_TETRA5
  ############
  #ELEM_TETRA6
  ############
  #ELEM_TETRA8
  ############
  M101     = [8,    121,    122,    133,    132,      0,      1,     12,     11,      1]
  M102     = [8,    122,    123,    134,    133,      1,      2,     13,     12,      2]
  M103     = [8,    123,    124,    135,    134,      2,      3,     14,     13,      3]
  M104     = [8,    124,    125,    136,    135,      3,      4,     15,     14,      4]
  M105     = [8,    125,    126,    137,    136,      4,      5,     16,     15,      5]
  M106     = [8,    126,    127,    138,    137,      5,      6,     17,     16,      6]
  M107     = [8,    127,    128,    139,    138,      6,      7,     18,     17,      7]
  M108     = [8,    128,    129,    140,    139,      7,      8,     19,     18,      8]
  M109     = [8,    129,    130,    141,    140,      8,      9,     20,     19,      9]
  M110     = [8,    130,    131,    142,    141,      9,     10,     21,     20,     10]
  M111     = [8,    132,    133,    144,    143,     11,     12,     23,     22,     11]
  M112     = [8,    133,    134,    145,    144,     12,     13,     24,     23,     12]
  M113     = [8,    134,    135,    146,    145,     13,     14,     25,     24,     13]
  M114     = [8,    135,    136,    147,    146,     14,     15,     26,     25,     14]
  M115     = [8,    136,    137,    148,    147,     15,     16,     27,     26,     15]
  M116     = [8,    137,    138,    149,    148,     16,     17,     28,     27,     16]
  M117     = [8,    138,    139,    150,    149,     17,     18,     29,     28,     17]
  M118     = [8,    139,    140,    151,    150,     18,     19,     30,     29,     18]
  M119     = [8,    140,    141,    152,    151,     19,     20,     31,     30,     19]
  M120     = [8,    141,    142,    153,    152,     20,     21,     32,     31,     20]
  M121     = [8,    143,    144,    155,    154,     22,     23,     34,     33,     21]
  M122     = [8,    144,    145,    156,    155,     23,     24,     35,     34,     22]
  M123     = [8,    145,    146,    157,    156,     24,     25,     36,     35,     23]
  M124     = [8,    146,    147,    158,    157,     25,     26,     37,     36,     24]
  M125     = [8,    147,    148,    159,    158,     26,     27,     38,     37,     25]
  M126     = [8,    148,    149,    160,    159,     27,     28,     39,     38,     26]
  M127     = [8,    149,    150,    161,    160,     28,     29,     40,     39,     27]
  M128     = [8,    150,    151,    162,    161,     29,     30,     41,     40,     28]
  M129     = [8,    151,    152,    163,    162,     30,     31,     42,     41,     29]
  M130     = [8,    152,    153,    164,    163,     31,     32,     43,     42,     30]
  M131     = [8,    154,    155,    166,    165,     33,     34,     45,     44,     31]
  M132     = [8,    155,    156,    167,    166,     34,     35,     46,     45,     32]
  M133     = [8,    156,    157,    168,    167,     35,     36,     47,     46,     33]
  M134     = [8,    157,    158,    169,    168,     36,     37,     48,     47,     34]
  M135     = [8,    158,    159,    170,    169,     37,     38,     49,     48,     35]
  M136     = [8,    159,    160,    171,    170,     38,     39,     50,     49,     36]
  M137     = [8,    160,    161,    172,    171,     39,     40,     51,     50,     37]
  M138     = [8,    161,    162,    173,    172,     40,     41,     52,     51,     38]
  M139     = [8,    162,    163,    174,    173,     41,     42,     53,     52,     39]
  M140     = [8,    163,    164,    175,    174,     42,     43,     54,     53,     40]
  M141     = [8,    165,    166,    177,    176,     44,     45,     56,     55,     41]
  M142     = [8,    166,    167,    178,    177,     45,     46,     57,     56,     42]
  M143     = [8,    167,    168,    179,    178,     46,     47,     58,     57,     43]
  M144     = [8,    168,    169,    180,    179,     47,     48,     59,     58,     44]
  M145     = [8,    169,    170,    181,    180,     48,     49,     60,     59,     45]
  M146     = [8,    170,    171,    182,    181,     49,     50,     61,     60,     46]
  M147     = [8,    171,    172,    183,    182,     50,     51,     62,     61,     47]
  M148     = [8,    172,    173,    184,    183,     51,     52,     63,     62,     48]
  M149     = [8,    173,    174,    185,    184,     52,     53,     64,     63,     49]
  M150     = [8,    174,    175,    186,    185,     53,     54,     65,     64,     50]
  M151     = [8,    176,    177,    188,    187,     55,     56,     67,     66,     51]
  M152     = [8,    177,    178,    189,    188,     56,     57,     68,     67,     52]
  M153     = [8,    178,    179,    190,    189,     57,     58,     69,     68,     53]
  M154     = [8,    179,    180,    191,    190,     58,     59,     70,     69,     54]
  M155     = [8,    180,    181,    192,    191,     59,     60,     71,     70,     55]
  M156     = [8,    181,    182,    193,    192,     60,     61,     72,     71,     56]
  M157     = [8,    182,    183,    194,    193,     61,     62,     73,     72,     57]
  M158     = [8,    183,    184,    195,    194,     62,     63,     74,     73,     58]
  M159     = [8,    184,    185,    196,    195,     63,     64,     75,     74,     59]
  M160     = [8,    185,    186,    197,    196,     64,     65,     76,     75,     60]
  M161     = [8,    187,    188,    199,    198,     66,     67,     78,     77,     61]
  M162     = [8,    188,    189,    200,    199,     67,     68,     79,     78,     62]
  M163     = [8,    189,    190,    201,    200,     68,     69,     80,     79,     63]
  M164     = [8,    190,    191,    202,    201,     69,     70,     81,     80,     64]
  M165     = [8,    191,    192,    203,    202,     70,     71,     82,     81,     65]
  M166     = [8,    192,    193,    204,    203,     71,     72,     83,     82,     66]
  M167     = [8,    193,    194,    205,    204,     72,     73,     84,     83,     67]
  M168     = [8,    194,    195,    206,    205,     73,     74,     85,     84,     68]
  M169     = [8,    195,    196,    207,    206,     74,     75,     86,     85,     69]
  M170     = [8,    196,    197,    208,    207,     75,     76,     87,     86,     70]
  M171     = [8,    198,    199,    210,    209,     77,     78,     89,     88,     71]
  M172     = [8,    199,    200,    211,    210,     78,     79,     90,     89,     72]
  M173     = [8,    200,    201,    212,    211,     79,     80,     91,     90,     73]
  M174     = [8,    201,    202,    213,    212,     80,     81,     92,     91,     74]
  M175     = [8,    202,    203,    214,    213,     81,     82,     93,     92,     75]
  M176     = [8,    203,    204,    215,    214,     82,     83,     94,     93,     76]
  M177     = [8,    204,    205,    216,    215,     83,     84,     95,     94,     77]
  M178     = [8,    205,    206,    217,    216,     84,     85,     96,     95,     78]
  M179     = [8,    206,    207,    218,    217,     85,     86,     97,     96,     79]
  M180     = [8,    207,    208,    219,    218,     86,     87,     98,     97,     80]
  M181     = [8,    209,    210,    221,    220,     88,     89,    100,     99,     81]
  M182     = [8,    210,    211,    222,    221,     89,     90,    101,    100,     82]
  M183     = [8,    211,    212,    223,    222,     90,     91,    102,    101,     83]
  M184     = [8,    212,    213,    224,    223,     91,     92,    103,    102,     84]
  M185     = [8,    213,    214,    225,    224,     92,     93,    104,    103,     85]
  M186     = [8,    214,    215,    226,    225,     93,     94,    105,    104,     86]
  M187     = [8,    215,    216,    227,    226,     94,     95,    106,    105,     87]
  M188     = [8,    216,    217,    228,    227,     95,     96,    107,    106,     88]
  M189     = [8,    217,    218,    229,    228,     96,     97,    108,    107,     89]
  M190     = [8,    218,    219,    230,    229,     97,     98,    109,    108,     90]
  M191     = [8,    220,    221,    232,    231,     99,    100,    111,    110,     91]
  M192     = [8,    221,    222,    233,    232,    100,    101,    112,    111,     92]
  M193     = [8,    222,    223,    234,    233,    101,    102,    113,    112,     93]
  M194     = [8,    223,    224,    235,    234,    102,    103,    114,    113,     94]
  M195     = [8,    224,    225,    236,    235,    103,    104,    115,    114,     95]
  M196     = [8,    225,    226,    237,    236,    104,    105,    116,    115,     96]
  M197     = [8,    226,    227,    238,    237,    105,    106,    117,    116,     97]
  M198     = [8,    227,    228,    239,    238,    106,    107,    118,    117,     98]
  M199     = [8,    228,    229,    240,    239,    107,    108,    119,    118,     99]
  M200     = [8,    229,    230,    241,    240,    108,    109,    120,    119,    100]
    #ELEM_TETRA4
    ############
    #ELEM_TETRA5
    ############
    #ELEM_TETRA6
    ############
    #ELEM_TETRA8
    ############
  Mesh_M1 = M101     + \
          M102     + \
          M103     + \
          M104     + \
          M105     + \
          M106     + \
          M107     + \
          M108     + \
          M109     + \
          M110     + \
          M111     + \
          M112     + \
          M113     + \
          M114     + \
          M115     + \
          M116     + \
          M117     + \
          M118     + \
          M119     + \
          M120     + \
          M121     + \
          M122     + \
          M123     + \
          M124     + \
          M125     + \
          M126     + \
          M127     + \
          M128     + \
          M129     + \
          M130     + \
          M131     + \
          M132     + \
          M133     + \
          M134     + \
          M135     + \
          M136     + \
          M137     + \
          M138     + \
          M139     + \
          M140     + \
          M141     + \
          M142     + \
          M143     + \
          M144     + \
          M145     + \
          M146     + \
          M147     + \
          M148     + \
          M149     + \
          M150     + \
          M151     + \
          M152     + \
          M153     + \
          M154     + \
          M155     + \
          M156     + \
          M157     + \
          M158     + \
          M159     + \
          M160     + \
          M161     + \
          M162     + \
          M163     + \
          M164     + \
          M165     + \
          M166     + \
          M167     + \
          M168     + \
          M169     + \
          M170     + \
          M171     + \
          M172     + \
          M173     + \
          M174     + \
          M175     + \
          M176     + \
          M177     + \
          M178     + \
          M179     + \
          M180     + \
          M181     + \
          M182     + \
          M183     + \
          M184     + \
          M185     + \
          M186     + \
          M187     + \
          M188     + \
          M189     + \
          M190     + \
          M191     + \
          M192     + \
          M193     + \
          M194     + \
          M195     + \
          M196     + \
          M197     + \
          M198     + \
          M199     + \
          M200    
       
  S199     = [100, 4,       0,      1,     12,     11,      11]
  S200     = [     4,       1,      2,     13,     12,      11]
  S201     = [     4,       2,      3,     14,     13,      11]
  S202     = [     4,       3,      4,     15,     14,      11]
  S203     = [     4,       4,      5,     16,     15,      11]
  S204     = [     4,       5,      6,     17,     16,      11]
  S205     = [     4,       6,      7,     18,     17,      11]
  S206     = [     4,       7,      8,     19,     18,      11]
  S207     = [     4,       8,      9,     20,     19,      11]
  S208     = [     4,       9,     10,     21,     20,      11]
  S209     = [     4,      11,     12,     23,     22,      11]
  S210     = [     4,      12,     13,     24,     23,      11]
  S211     = [     4,      13,     14,     25,     24,      11]
  S212     = [     4,      14,     15,     26,     25,      11]
  S213     = [     4,      15,     16,     27,     26,      11]
  S214     = [     4,      16,     17,     28,     27,      11]
  S215     = [     4,      17,     18,     29,     28,      11]
  S216     = [     4,      18,     19,     30,     29,      11]
  S217     = [     4,      19,     20,     31,     30,      11]
  S218     = [     4,      20,     21,     32,     31,      11]
  S219     = [     4,      22,     23,     34,     33,      11]
  S220     = [     4,      23,     24,     35,     34,      11]
  S221     = [     4,      24,     25,     36,     35,      11]
  S222     = [     4,      25,     26,     37,     36,      11]
  S223     = [     4,      26,     27,     38,     37,      11]
  S224     = [     4,      27,     28,     39,     38,      11]
  S225     = [     4,      28,     29,     40,     39,      11]
  S226     = [     4,      29,     30,     41,     40,      11]
  S227     = [     4,      30,     31,     42,     41,      11]
  S228     = [     4,      31,     32,     43,     42,      11]
  S229     = [     4,      33,     34,     45,     44,      11]
  S230     = [     4,      34,     35,     46,     45,      11]
  S231     = [     4,      35,     36,     47,     46,      11]
  S232     = [     4,      36,     37,     48,     47,      11]
  S233     = [     4,      37,     38,     49,     48,      11]
  S234     = [     4,      38,     39,     50,     49,      11]
  S235     = [     4,      39,     40,     51,     50,      11]
  S236     = [     4,      40,     41,     52,     51,      11]
  S237     = [     4,      41,     42,     53,     52,      11]
  S238     = [     4,      42,     43,     54,     53,      11]
  S239     = [     4,      44,     45,     56,     55,      11]
  S240     = [     4,      45,     46,     57,     56,      11]
  S241     = [     4,      46,     47,     58,     57,      11]
  S242     = [     4,      47,     48,     59,     58,      11]
  S243     = [     4,      48,     49,     60,     59,      11]
  S244     = [     4,      49,     50,     61,     60,      11]
  S245     = [     4,      50,     51,     62,     61,      11]
  S246     = [     4,      51,     52,     63,     62,      11]
  S247     = [     4,      52,     53,     64,     63,      11]
  S248     = [     4,      53,     54,     65,     64,      11]
  S249     = [     4,      55,     56,     67,     66,      11]
  S250     = [     4,      56,     57,     68,     67,      11]
  S251     = [     4,      57,     58,     69,     68,      11]
  S252     = [     4,      58,     59,     70,     69,      11]
  S253     = [     4,      59,     60,     71,     70,      11]
  S254     = [     4,      60,     61,     72,     71,      11]
  S255     = [     4,      61,     62,     73,     72,      11]
  S256     = [     4,      62,     63,     74,     73,      11]
  S257     = [     4,      63,     64,     75,     74,      11]
  S258     = [     4,      64,     65,     76,     75,      11]
  S259     = [     4,      66,     67,     78,     77,      11]
  S260     = [     4,      67,     68,     79,     78,      11]
  S261     = [     4,      68,     69,     80,     79,      11]
  S262     = [     4,      69,     70,     81,     80,      11]
  S263     = [     4,      70,     71,     82,     81,      11]
  S264     = [     4,      71,     72,     83,     82,      11]
  S265     = [     4,      72,     73,     84,     83,      11]
  S266     = [     4,      73,     74,     85,     84,      11]
  S267     = [     4,      74,     75,     86,     85,      11]
  S268     = [     4,      75,     76,     87,     86,      11]
  S269     = [     4,      77,     78,     89,     88,      11]
  S270     = [     4,      78,     79,     90,     89,      11]
  S271     = [     4,      79,     80,     91,     90,      11]
  S272     = [     4,      80,     81,     92,     91,      11]
  S273     = [     4,      81,     82,     93,     92,      11]
  S274     = [     4,      82,     83,     94,     93,      11]
  S275     = [     4,      83,     84,     95,     94,      11]
  S276     = [     4,      84,     85,     96,     95,      11]
  S277     = [     4,      85,     86,     97,     96,      11]
  S278     = [     4,      86,     87,     98,     97,      11]
  S279     = [     4,      88,     89,    100,     99,      11]
  S280     = [     4,      89,     90,    101,    100,      11]
  S281     = [     4,      90,     91,    102,    101,      11]
  S282     = [     4,      91,     92,    103,    102,      11]
  S283     = [     4,      92,     93,    104,    103,      11]
  S284     = [     4,      93,     94,    105,    104,      11]
  S285     = [     4,      94,     95,    106,    105,      11]
  S286     = [     4,      95,     96,    107,    106,      11]
  S287     = [     4,      96,     97,    108,    107,      11]
  S288     = [     4,      97,     98,    109,    108,      11]
  S289     = [     4,      99,    100,    111,    110,      11]
  S290     = [     4,     100,    101,    112,    111,      11]
  S291     = [     4,     101,    102,    113,    112,      11]
  S292     = [     4,     102,    103,    114,    113,      11]
  S293     = [     4,     103,    104,    115,    114,      11]
  S294     = [     4,     104,    105,    116,    115,      11]
  S295     = [     4,     105,    106,    117,    116,      11]
  S296     = [     4,     106,    107,    118,    117,      11]
  S297     = [     4,     107,    108,    119,    118,      11]
  S298     = [     4,     108,    109,    120,    119,      11]
  
  
  Surf_M1_INT = S199     + \
          S200     + \
          S201     + \
          S202     + \
          S203     + \
          S204     + \
          S205     + \
          S206     + \
          S207     + \
          S208     + \
          S209     + \
          S210     + \
          S211     + \
          S212     + \
          S213     + \
          S214     + \
          S215     + \
          S216     + \
          S217     + \
          S218     + \
          S219     + \
          S220     + \
          S221     + \
          S222     + \
          S223     + \
          S224     + \
          S225     + \
          S226     + \
          S227     + \
          S228     + \
          S229     + \
          S230     + \
          S231     + \
          S232     + \
          S233     + \
          S234     + \
          S235     + \
          S236     + \
          S237     + \
          S238     + \
          S239     + \
          S240     + \
          S241     + \
          S242     + \
          S243     + \
          S244     + \
          S245     + \
          S246     + \
          S247     + \
          S248     + \
          S249     + \
          S250     + \
          S251     + \
          S252     + \
          S253     + \
          S254     + \
          S255     + \
          S256     + \
          S257     + \
          S258     + \
          S259     + \
          S260     + \
          S261     + \
          S262     + \
          S263     + \
          S264     + \
          S265     + \
          S266     + \
          S267     + \
          S268     + \
          S269     + \
          S270     + \
          S271     + \
          S272     + \
          S273     + \
          S274     + \
          S275     + \
          S276     + \
          S277     + \
          S278     + \
          S279     + \
          S280     + \
          S281     + \
          S282     + \
          S283     + \
          S284     + \
          S285     + \
          S286     + \
          S287     + \
          S288     + \
          S289     + \
          S290     + \
          S291     + \
          S292     + \
          S293     + \
          S294     + \
          S295     + \
          S296     + \
          S297     + \
          S298
  		 
  bulk = BULK_MATERIAL (solfec,
                        model = 'KIRCHHOFF',
                        young = 62.8E+06,
                        poisson = 0.3,
                        density = 7.850E+00)
  
                                          
  Msh_M1 = MESH(Nodes_M1,Mesh_M1,Surf_M1_INT)
  
  Msh_M2 = MESH(Nodes_M1,Mesh_M1,1)
  
  Mesh_final = Msh_M1
  
  Node=[]
  for i in Mesh_final.nodes_on_surface(11):
    Node.append(Mesh_final.node(i))
  
  
  FIX_Z=[]  
  FIX_Z.append(Mesh_final.node(110))
  FIX_Z.append(Mesh_final.node(111))
  FIX_Z.append(Mesh_final.node(112))
  FIX_Z.append(Mesh_final.node(113))
  FIX_Z.append(Mesh_final.node(114))
  FIX_Z.append(Mesh_final.node(115))
  FIX_Z.append(Mesh_final.node(116))
  FIX_Z.append(Mesh_final.node(117))
  FIX_Z.append(Mesh_final.node(118))
  FIX_Z.append(Mesh_final.node(119))
  FIX_Z.append(Mesh_final.node(120))
  
  FIX_X=[]
  FIX_X.append(Mesh_final.node(0))
  FIX_X.append(Mesh_final.node(1))
  FIX_X.append(Mesh_final.node(2))
  FIX_X.append(Mesh_final.node(3))
  FIX_X.append(Mesh_final.node(4))
  FIX_X.append(Mesh_final.node(5))
  FIX_X.append(Mesh_final.node(6))
  FIX_X.append(Mesh_final.node(7))
  FIX_X.append(Mesh_final.node(8))
  FIX_X.append(Mesh_final.node(9))
  
  
  Point_A=Mesh_final.node(0)
  Point_B=Mesh_final.node(110)
  Point_C=Mesh_final.node(10)
  
  Bod_M1 = BODY (solfec, 'FINITE_ELEMENT',Mesh_final,bulk)
  
  for i in range (0,len(Node)):
    DISPLAY_POINT (Bod_M1, Node[i], 'N%d'%i) # press 'D' in the viewer to see display points
  
  FIX_DIRECTION (Bod_M1, Point_C, (1.,0.,0.))
  FIX_DIRECTION (Bod_M1, Point_C, (0.,1.,0.))
   
  Fix_direc_X=(1.,0.,0.)
  for fix in FIX_X:
    FIX_DIRECTION (Bod_M1, fix, Fix_direc_X)
  
  Fix_direc_Z=(0.,0.,1.)
  for fix in FIX_Z:
    FIX_DIRECTION (Bod_M1, fix, Fix_direc_Z)
    
  F=2   #N
  FORCE(Bod_M1,'SPATIAL', Point_A,(0,0,1),-F)
  FORCE(Bod_M1,'SPATIAL', Point_B,(1,0,0),F)
  
  gs= GAUSS_SEIDEL_SOLVER (1E-3 , 1000)
  gs_imp= GAUSS_SEIDEL_SOLVER (1E-6 , 1000, 1E-6)
  nt = NEWTON_SOLVER ()
  nt_imp= NEWTON_SOLVER (1E-9, 1000, delta = 1E-6)
  OUTPUT (solfec, outstep)
  if not VIEWER() and solfec.mode == 'WRITE':
    solfec.verbose = '%'
  RUN (solfec, gs_imp, stop)
  return solfec

# data
step = 2E-2
stop = 2.0
outstep = 5E-2

# calculate
solfec = create_simulation (step, stop, outstep)

# read results
if not VIEWER():
  solfec = create_simulation (step, stop, outstep)
  if solfec.mode != 'READ':
    print 'READ ERROR'
    import sys
    sys.exit(1)

  body = solfec.bodies[0]
  mesh = body.mesh
  A = mesh.node(110)
  SEEK (solfec, stop)
  disp = DISPLACEMENT (body, A)
 
  Value = abs(disp[0])
  Code_Aster_Ref = 1.16E-03

  if abs(Value-Code_Aster_Ref) < 0.01E-3:
    print '\b\b\b\bPASSED'
  else:
    print '\b\b\b\bFAILED', 
    print '(Computed displacement was %g' % Value, 'while reference is %g)' % Code_Aster_Ref
